---
# Installs and configures ufw, which in turn uses iptables for firewall management.
# ufw includes sensible ICMP defaults.

- name: Install ufw
  apt: pkg=ufw state=present
  tags:
    - dependencies

- name: Deny everything incoming
  ufw: policy=deny direction=incoming

- name: Allow outgoing traffic
  ufw: policy=allow direction=outgoing

- name: Set firewall rule for DNS
  ufw: rule=allow port=domain

- name: Set firewall rule for mosh
  ufw: rule=allow port=60000:61000 proto=udp

- name: Set firewall rules for SSH
  ufw: rule=allow port=ssh proto=tcp

- name: Enable UFW
  ufw: state=enabled
